)+
scale_x_continuous(
breaks = 1:10,
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(2.15,2.31),
labels = c("2.15\n|","2.31\n|\n|"))
)+
scale_y_continuous(expand = c(0,0))+
scale_fill_brewer(palette = "Set1")+
theme(axis.ticks.x.top = element_blank())
catan_df %>%
mutate(GainLoss = tradeGain/tradeLoss) %>%
ggplot(aes(GainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
labs(
fill = "",
y = "Density",
x = "(Trade gain) / (Trade loss)"
)+
scale_x_continuous(
breaks = 1:10,
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(2.15,2.31),
labels = c("2.15\n|","2.31\n|\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
mutate(GainLoss = tradeGain/tradeLoss) %>%
ggplot(aes(GainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
fill = "",
y = "Density",
col = "Initial port:",
x = "(Trade gain) / (Trade loss)"
)+
scale_x_continuous(
breaks = 1:10,
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(2.15,2.31),
labels = c("2.15\n|","2.31\n|\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
mutate(GainLoss = tradeGain/tradeLoss) %>%
ggplot(aes(GainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
fill = "",
y = "Density",
fill = "Initial port:",
x = "(Trade gain) / (Trade loss)"
)+
scale_x_continuous(
breaks = 1:10,
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(2.15,2.31),
labels = c("2.15\n|","2.31\n|\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
mutate(TradeGainLoss = tradeGain/tradeLoss) %>%
ggplot(aes(TradeGainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
fill = "",
y = "Density",
fill = "Initial port:",
x = "(Trade gain) / (Trade loss)"
)+
scale_x_continuous(
breaks = 1:10,
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(2.15,2.31),
labels = c("2.15\n|","2.31\n|\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
mutate(TradeGainLoss = tradeGain/tradeLoss) %>%
ggplot(aes(TradeGainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
fill = "",
y = "Density",
fill = "Initial port:",
x = "(Trade gain) / (Trade loss)"
)+
scale_x_continuous(
breaks = 1:10,
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(2.15,2.31),
labels = c("2.15\n|","2.31\n|\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))+
scale_x_continuous(breaks = seq(-2,2,.2))
catan_df %>%
mutate(TradeGainLoss = tradeGain/tradeLoss) %>%
ggplot(aes(TradeGainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
fill = "",
y = "Density",
fill = "Initial port:",
x = "(Trade gain) / (Trade loss)"
)+
scale_x_continuous(
breaks = seq(0,2,.2),
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(2.15,2.31),
labels = c("2.15\n|","2.31\n|\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
mutate(TradeGainLoss = tradeGain/tradeLoss) %>%
ggplot(aes(TradeGainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
fill = "",
y = "Density",
fill = "Initial port:",
x = "(Trade gain) / (Trade loss)"
)+
scale_x_continuous(
breaks = seq(0,2,.1),
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(2.15,2.31),
labels = c("2.15\n|","2.31\n|\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
mutate(TradeGainLoss = tradeGain/tradeLoss) %>%
group_by(Port) %>%
summarise(calc_peak_density(TradeGainLoss))
catan_df %>%
mutate(TradeGainLoss = tradeGain/tradeLoss) %>%
# group_by(Port) %>%
# summarise(calc_peak_density(TradeGainLoss))
ggplot(aes(TradeGainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
y = "Density",
fill = "Initial port:",
x = "(Trade gain) / (Trade loss)"
)+
scale_x_continuous(
breaks = seq(0,2,.1),
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(0.461,0.553),
labels = c("0.461\n|","0.553\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
mutate(TradeGainLoss = tradeGain/tradeLoss) %>%
# group_by(Port) %>%
# summarise(calc_peak_density(TradeGainLoss))
ggplot(aes(TradeGainLoss,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
y = "Density",
fill = "Initial port:",
x = "(Trade gain) / (Trade loss)",
caption = "Source: @lumin (Kaggle)"
)+
scale_x_continuous(
breaks = seq(0,2,.1),
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(0.461,0.553),
labels = c("0.461\n|","0.553\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
# group_by(Port) %>%
# summarise(calc_peak_density(TradeGainLoss))
ggplot(aes(production,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
y = "Density",
fill = "Initial port:",
x = "(Trade gain) / (Trade loss)",
caption = "Source: @lumin (Kaggle)."
)+
scale_x_continuous(
breaks = seq(0,2,.1),
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(0.461,0.553),
labels = c("0.461\n|","0.553\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
# group_by(Port) %>%
# summarise(calc_peak_density(TradeGainLoss))
ggplot(aes(production,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
y = "Density",
fill = "Initial port:",
x = "Production",
caption = "Source: @lumin (Kaggle)."
)+
scale_x_continuous(
# breaks = seq(0,2,.1),
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(0.461,0.553),
labels = c("0.461\n|","0.553\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
catan_df %>%
group_by(Port) %>%
summarise(calc_peak_density(production))
catan_df %>%
# group_by(Port) %>%
# summarise(calc_peak_density(production))
ggplot(aes(production,fill = Port))+
geom_density(alpha = .7)+
plt_theme_x()+
plt_water_mark(vfx_watermark)+
plt_flip_y_title+
labs(
y = "Density",
fill = "Initial port:",
x = "Production",
caption = "Source: @lumin (Kaggle)."
)+
scale_x_continuous(
breaks = seq(0,100,10),
expand = c(0,0),
sec.axis = sec_axis(
trans = ~.,
breaks = c(54.6,38.7),
labels = c("54.6\n|","38.7\n|"))
)+
scale_y_continuous(expand = c(0,0))+
theme(axis.ticks.x.top = element_blank())+
scale_fill_manual(values = c("purple","darkgoldenrod2"))
38.7-54.6
catan_df %>%
count(tribute)
catan_df %>%
count(tribute = tribute > 0)
catan_df %>%
count(robbed = tribute > 0)
catan_df %>%
count(robbed = tribute > 0, winner)
catan_df %>%
count(robbed = tribute > 0, winner) %>%
mutate(p = as_perc(n))
catan_df %>%
count(robbed = tribute > 0, winner) %>%
mutate(p = as_perc(n,T))
catan_df %>%
count(robbed = tribute > 0, winner) %>%
group_by(robbed) %>%
mutate(p = as_perc(n,T))
catan_df %>%
count(robbed = tribute > 0, winner) %>%
group_by(winner) %>%
mutate(p = as_perc(n,T))
catan_df %>%
filter(winner == "Winner") %>%
count(robbed = tribute > 0, winner) %>%
mutate(p = as_perc(n,T))
catan_df %>% group_by(Port) %>% summarise(num_summary(tradeGain))
catan_df %>% group_by(Port) %>% summarise(summary_num(tradeGain))
catan_df %>% group_by(Port) %>% summarise(summary_num(tradeLoss))
lsf.str("package:tidyr")
library(tidyr)
?chop()
df <- tibble(x = 1:4, y = list(integer(), 1L, 1:2, 1:3))
df %>% unchop(y)
df
library(tidyr)
data.frame(x = c(1,2),y = c("a","b"))
data.frame(x = c(1,2),y = c("a","b")) %>%
complete()
?complete()
data.frame(x = c(1,2),y = c("a","b"), z = 1:2) %>%
complete()
data.frame(x = c(1,1,2,2),y = c("a","b","a",NA)) %>%
complete()
data.frame(x = c(1,1,2,2),y = c("a","b","a",NA))
data.frame(x = c(1,1,2,2),y = c("a","b","a",NA)) %>%
complete(x,y)
data.frame(x = c(1,1,2),y = c("a","b","a")) %>%
complete(x,y)
data.frame(x = c(1,2),y = c("a","b")) %>%
complete(x,y)
?crossing
?drop_na()
data.frame(x = c(1,2,NA),y = c("a","b","C")) %>%
drop_na(x,y)
?expand()
expand_grid(x = 1:2,y = c("a","b"))
?extract()
df <- data.frame(x = c(NA, "a-b", "a-d", "b-c", "d-e"))
df %>% extract(x, "A")
data.frame(x = c("a",NA,"b",NA))
data.frame(x = c("a",NA,"b",NA)) %>%
fill(x,.direction = "down")
?hoist()
?pack()
?replace_na()
data.frame(x = c("a",NA), y = c(1,NA)) %>%
replace_na(list(x = "x", y = 0))
data.frame(x =c("a","b"), y = c(1,2)) %>%
count(x = x,wt = y)
data.frame(x =c("a","b"), y = c(1,2)) %>%
count(wt = y)
data.frame(x =c("a","b"), y = c(1,2)) %>%
count(x,wt = y)
data.frame(x =c("a","b"), y = c(1,2)) %>%
uncount(x,y)
data.frame(x =c("a","b"), y = c(1,2)) %>%
uncount(weights = y)
df1 <-
tibble::tribble(
~Name,       ~Key, ~BCD12A, ~ACA1, ~DEX2,
"X_1_group1", "test1234",     10L,   10L,    8L,
"X_2_group1", "test4553",      8L,    7L,    4L,
"X_2_group2", "test3341",      5L,    5L,    5L,
"X_2_group1", "test2142",      5L,    6L,    8L,
"X_1_group2", "test4722",      6L,    7L,    4L
)
df1
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
df1 %>%
left_join(df2 %>% select(-key),suffix = c("test","baseline"),by = "Name")
df1 %>%
left_join(df2 %>% select(-Key),suffix = c("test","baseline"),by = "Name")
df1 %>%
left_join(df2 %>% select(-Key),suffix = c("","baseline"),by = "Name")
df1 %>%
left_join(df2 %>% select(-Key),suffix = c("","_baseline"),by = "Name")
df1 %>%
left_join(df2 %>% select(-Key),suffix = c("","_baseline"),by = "Name") %>%
mutate(across(
.cols = BCD12A:DEX2,
.fns = ~ . -(get(paste0(cur_column(),"_baseline")))
))
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
df1[,3:5] - df2[,3:5]
df2
df1
df1[,3:5]
df2[,3:5]
source("~/.active-rstudio-document", echo=TRUE)
library(dplyr)
library(tidyr)
data <-
tibble(
rep(1:2,3)
)
tibble(
rep(1:2,3)
)
data <-
tibble(
block = rep(1:2,3),
treatment = round(x = runif(n = 6,min = 1,max = 6),digits = 0)
)
tibble(
block = rep(1:2,3),
treatment = round(x = runif(n = 6,min = 1,max = 6),digits = 0)
)
data %>%
mutate(treatment = if_else(treatment <= 3,"123","456"))
data %>%
mutate(treatment = if_else(treatment <= 3,"123","456"))
data
data %>%
mutate(treatment = if_else(treatment <= 3,"123","456"))
data %>%
mutate(treatment = if_else(treatment <= 3,"123","456")) %>%
pivot_wider(names_from = treatment,values_from = block)
data %>%
mutate(treatment = if_else(treatment <= 3,"123","456")) %>%
pivot_wider(names_from = treatment,values_from = block) %>%
unnest()
data %>%
mutate(treatment = if_else(treatment <= 3,"123","456")) %>%
pivot_wider(names_from = treatment,values_from = block) %>%
unlist()
data %>%
mutate(treatment = if_else(treatment <= 3,"123","456")) %>%
pivot_wider(names_from = treatment,values_from = block) %>%
unnest()
data %>%
mutate(
fator1 = treatment <= 3,
fator2 = -fator1
)
data %>%
mutate(
fator1 = treatment <= 3,
fator2 = !fator1
)
rep(x = c("zero","low","high"),2)
rep(x = c("on","off"),each = 3)
data %>%
mutate(
factorA = factor(
x = treatment,
levels = 1:6,
labels = rep(x = c("zero","low","high"),2)
),
factorB = factor(
x = treatment,
levels = 1:6,
labels = rep(x = c("on","off"),each = 3)
)
)
data <-
tibble(
block = rep(1:2,3),
treatment = c(6,2,4,5,3,1)
)
data %>%
mutate(
factorA = factor(
x = treatment,
levels = 1:6,
labels = rep(x = c("zero","low","high"),2)
),
factorB = factor(
x = treatment,
levels = 1:6,
labels = rep(x = c("on","off"),each = 3)
)
)
1/0
x <- 'abc'
x
abc
