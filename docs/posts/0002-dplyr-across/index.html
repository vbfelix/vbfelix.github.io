<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vinícius Félix">
<meta name="dcterms.date" content="2023-01-02">

<title>vbfelix - An intro to: dplyr::across</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//images/favicon/favicon-32x32.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">vbfelix</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../header-about.html" rel="" target="">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../header-publications.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../header-certifications.html" rel="" target="">
 <span class="menu-text">Certifications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../header-participations.html" rel="" target="">
 <span class="menu-text">Participations</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vbfelix" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/vin%C3%ADcius-f%C3%A9lix-962010140/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://stackoverflow.com/users/9696037/vin%c3%adcius-f%c3%a9lix" rel="" target=""><i class="bi bi-stack-overflow" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://vbfelix.github.io/relper" rel="" target=""><i class="bi bi-box-seam" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">An intro to: dplyr::across</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Intro to</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">Tools</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vinícius Félix </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 2, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#context" id="toc-context" class="nav-link active" data-scroll-target="#context">Context</a>
  <ul class="collapse">
  <li><a href="#before-across" id="toc-before-across" class="nav-link" data-scroll-target="#before-across">Before across</a></li>
  </ul></li>
  <li><a href="#across" id="toc-across" class="nav-link" data-scroll-target="#across">across</a>
  <ul class="collapse">
  <li><a href="#cols" id="toc-cols" class="nav-link" data-scroll-target="#cols">.cols</a>
  <ul class="collapse">
  <li><a href="#default" id="toc-default" class="nav-link" data-scroll-target="#default">Default</a></li>
  <li><a href="#by-type" id="toc-by-type" class="nav-link" data-scroll-target="#by-type">By type</a></li>
  <li><a href="#by-name" id="toc-by-name" class="nav-link" data-scroll-target="#by-name">By name</a></li>
  <li><a href="#by-order" id="toc-by-order" class="nav-link" data-scroll-target="#by-order">By order</a></li>
  </ul></li>
  <li><a href="#fns" id="toc-fns" class="nav-link" data-scroll-target="#fns">.fns</a></li>
  <li><a href="#names" id="toc-names" class="nav-link" data-scroll-target="#names">.names</a></li>
  </ul></li>
  <li><a href="#c_across" id="toc-c_across" class="nav-link" data-scroll-target="#c_across">c_across</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>In this post you will learn to never repeat a function again inside a <code>dplyr</code> pipeline.</p>
<section id="context" class="level1">
<h1>Context</h1>
<p>As described in their site, <a href="https://www.tidyverse.org/">Tidyverse</a> is an opinionated collection of R packages developed for data applications. One of the ecosystem main packages is <a href="https://dplyr.tidyverse.org/">dplyr</a>, which offers a consistent set of verbs to assist you in resolving data manipulation problems.</p>
<p>In June of 2020 we had the official release of <a href="https://www.tidyverse.org/blog/2020/06/dplyr-1-0-0/">dplyr 1.0.0</a> where a new function was introduced to us, opening new possibilities to data manipulation, that was the birth of <code>across</code> one of the most powerful and versatily functions to work with data.</p>
<p>Before talking about it, let’s see how we used to work before.</p>
<section id="before-across" class="level2">
<h2 class="anchored" data-anchor-id="before-across">Before across</h2>
<p>As one of thre greatest R packages, <code>dplyr</code> possesses a lot functions, but it has two main verbs to manipulate data, they are:</p>
<ul>
<li><p><code>summarise</code>: allows us to apply a transformation to data that reduce the number of observations, e.g., mean;</p></li>
<li><p><code>mutate</code>: allows us to apply a transformation to our existing variables or even creating new ones with the same size, e.g., multiplying one variable by 2.</p></li>
</ul>
<p>Let’s see how they work in practice:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel~
$ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse~
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, ~
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, ~
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186~
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, ~
$ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male~
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007~</code></pre>
</div>
</div>
<p>We will summarize every numerical variable using the dataset <code>penguins</code> from the <code>palmerpenguins</code> package, computing the mean for each. The mean function can then be applied to each variable inside the verb <code>summarize</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(bill_depth_mm,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(flipper_length_mm,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(body_mass_g,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 4
$ `mean(bill_length_mm, na.rm = TRUE)`    &lt;dbl&gt; 43.92193
$ `mean(bill_depth_mm, na.rm = TRUE)`     &lt;dbl&gt; 17.15117
$ `mean(flipper_length_mm, na.rm = TRUE)` &lt;dbl&gt; 200.9152
$ `mean(body_mass_g, na.rm = TRUE)`       &lt;dbl&gt; 4201.754</code></pre>
</div>
</div>
<p>In the example above we see that it works, but have some problems:</p>
<ol type="1">
<li><p>Due to its manual nature and increased risk of human error from writing numerous lines of code or even copying and pasting it, it would become a tiresome task if there were many columns;</p></li>
<li><p>The function will be given to the new tvariables as their names if their names are not set.</p></li>
</ol>
<p>A smarter approach is the use of a <code>summarise</code> variant, called <code>summarise_if</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_if</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">.predicate =</span> is.numeric,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.funs =</span> <span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 5
$ bill_length_mm    &lt;dbl&gt; 43.92193
$ bill_depth_mm     &lt;dbl&gt; 17.15117
$ flipper_length_mm &lt;dbl&gt; 200.9152
$ body_mass_g       &lt;dbl&gt; 4201.754
$ year              &lt;dbl&gt; 2008.029</code></pre>
</div>
</div>
<p>In the example above we see that inside <code>summarise_if</code> we define two argumens:</p>
<ol type="1">
<li><p><code>.predicate</code>: the condition to check which variables we are going to apply the functions;</p></li>
<li><p><code>.funs</code>: a function or list of functions.</p></li>
</ol>
<p>Even though these variables are the means of the originals, unlike the first method, the function here kept the names of the original variables. The fact that we can now apply a function to 5 columns with only 2 lines of code is another advantage.</p>
<p>So it was successful, but what is the issue? What if I also wanted to learn the mode of the variable species? How could we go about doing that?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> relper<span class="sc">::</span><span class="fu">calc_mode</span>(species),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.numeric),<span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 6
$ species           &lt;fct&gt; Adelie
$ bill_length_mm    &lt;dbl&gt; 43.92193
$ bill_depth_mm     &lt;dbl&gt; 17.15117
$ flipper_length_mm &lt;dbl&gt; 200.9152
$ body_mass_g       &lt;dbl&gt; 4201.754
$ year              &lt;dbl&gt; 2008.029</code></pre>
</div>
</div>
<p>In the example above we apply <code>across</code> , we see that it is used inside the conventional verb <code>summarise</code> , meaning we can still apply other functions even using <code>across</code>.</p>
<p>So <code>across</code> is a function that is complementary to <code>mutate</code> and <code>summarise</code>, that allows us to apply multiples functions across multiples variables.</p>
<p>Just as curiosity, even though this old functions are superseeded they still exists, and their suffixes are <code>_at()</code> , <code>_if()</code> and <code>_all()</code> .</p>
</section>
</section>
<section id="across" class="level1">
<h1>across</h1>
<p>Now that we understood the overall goal of <code>across</code>, we will explore each argument of the function.</p>
<section id="cols" class="level2">
<h2 class="anchored" data-anchor-id="cols">.cols</h2>
<p>The first argument of <code>across</code> determine which columns of the data.frame we are going to apply our functions, this argument is:</p>
<ul>
<li><p>Non-optional</p></li>
<li><p>The default is every single variable of the data.frame, by using the function <code>everything</code>.</p></li>
<li><p>Accepts as input:</p>
<ul>
<li><p>Integers, referencing the variables positions;</p></li>
<li><p>Strings, referencing the variables names;</p></li>
<li><p>Select helpers functions, e.g., <code>contains</code>, as we will see below.</p></li>
</ul></li>
</ul>
<section id="default" class="level3">
<h3 class="anchored" data-anchor-id="default">Default</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.fns =</span> as.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;chr&gt; "Adelie", "Adelie", "Adelie", "Adelie", "Adelie", "A~
$ island            &lt;chr&gt; "Torgersen", "Torgersen", "Torgersen", "Torgersen", ~
$ bill_length_mm    &lt;chr&gt; "39.1", "39.5", "40.3", NA, "36.7", "39.3", "38.9", ~
$ bill_depth_mm     &lt;chr&gt; "18.7", "17.4", "18", NA, "19.3", "20.6", "17.8", "1~
$ flipper_length_mm &lt;chr&gt; "181", "186", "195", NA, "193", "190", "181", "195",~
$ body_mass_g       &lt;chr&gt; "3750", "3800", "3250", NA, "3450", "3650", "3625", ~
$ sex               &lt;chr&gt; "male", "female", "female", NA, "female", "male", "f~
$ year              &lt;chr&gt; "2007", "2007", "2007", "2007", "2007", "2007", "200~</code></pre>
</div>
</div>
<p>In the example above we apply the function <code>as.character</code> to every column, since we did not use an input to the argument <code>.cols</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">everything</span>(),<span class="at">.fns =</span> as.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;chr&gt; "Adelie", "Adelie", "Adelie", "Adelie", "Adelie", "A~
$ island            &lt;chr&gt; "Torgersen", "Torgersen", "Torgersen", "Torgersen", ~
$ bill_length_mm    &lt;chr&gt; "39.1", "39.5", "40.3", NA, "36.7", "39.3", "38.9", ~
$ bill_depth_mm     &lt;chr&gt; "18.7", "17.4", "18", NA, "19.3", "20.6", "17.8", "1~
$ flipper_length_mm &lt;chr&gt; "181", "186", "195", NA, "193", "190", "181", "195",~
$ body_mass_g       &lt;chr&gt; "3750", "3800", "3250", NA, "3450", "3650", "3625", ~
$ sex               &lt;chr&gt; "male", "female", "female", NA, "female", "male", "f~
$ year              &lt;chr&gt; "2007", "2007", "2007", "2007", "2007", "2007", "200~</code></pre>
</div>
</div>
<p>In the example above we see that same result is obtained from the previous, since the default of <code>.cols</code> is <code>everything</code>.</p>
</section>
<section id="by-type" class="level3">
<h3 class="anchored" data-anchor-id="by-type">By type</h3>
<p>If we want to select variables by their type we can use the function <code>where</code> + a function that check the variable type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.factor),<span class="at">.fns =</span> toupper)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;chr&gt; "ADELIE", "ADELIE", "ADELIE", "ADELIE", "ADELIE", "A~
$ island            &lt;chr&gt; "TORGERSEN", "TORGERSEN", "TORGERSEN", "TORGERSEN", ~
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, ~
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, ~
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186~
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, ~
$ sex               &lt;chr&gt; "MALE", "FEMALE", "FEMALE", NA, "FEMALE", "MALE", "F~
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007~</code></pre>
</div>
</div>
<p>In the example above we made all factor variables to be uppercase.</p>
<p>Other functions can also be used, such as:</p>
<ul>
<li><p><code>is.numeric:</code> check if the variable is numeric;</p>
<ul>
<li><p><code>is.integer</code> check if the variable is an integer;</p></li>
<li><p><code>is.double</code> check if the variable is a double;</p></li>
</ul></li>
<li><p><code>is.factor</code> check if the variable is a factor;</p></li>
<li><p><code>is.character</code> check if the variable is a character;</p></li>
<li><p><code>is.logical</code> check if the variable is a boolean (<code>TRUE</code>/<code>FALSE</code>).</p></li>
</ul>
<p>We can also combine more than one function in the same <code>across</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.factor) <span class="sc">|</span> <span class="fu">where</span>(is.character),<span class="at">.fns =</span> toupper)) <span class="sc">%&gt;%</span>   <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;chr&gt; "ADELIE", "ADELIE", "ADELIE", "ADELIE", "ADELIE", "A~
$ island            &lt;chr&gt; "TORGERSEN", "TORGERSEN", "TORGERSEN", "TORGERSEN", ~
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, ~
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, ~
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186~
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, ~
$ sex               &lt;chr&gt; "MALE", "FEMALE", "FEMALE", NA, "FEMALE", "MALE", "F~
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007~</code></pre>
</div>
</div>
<p>In the example above we made all factor (<code>species</code> and <code>island</code>) and character (<code>sex</code>) variables to be uppercase.</p>
</section>
<section id="by-name" class="level3">
<h3 class="anchored" data-anchor-id="by-name">By name</h3>
<p>Another method of column selection is by using their name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">ends_with</span>(<span class="st">"_mm"</span>),<span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 3
$ bill_length_mm    &lt;dbl&gt; 43.92193
$ bill_depth_mm     &lt;dbl&gt; 17.15117
$ flipper_length_mm &lt;dbl&gt; 200.9152</code></pre>
</div>
</div>
<p>In the example above we compute the mean for the variables that ends with the pattern <em><code>_mm</code>.</em></p>
<p>So all the the selection helpers can be used:</p>
<ul>
<li><p><code>all_of</code>: allows us to pass a string vector to select specific variables, that helps when we are looking for a group of variables, which not obey a simples check condition such as been of the same type or having the a name pattern, e.g., <code>all_of(vector_of_variables)</code> ;</p></li>
<li><p><code>any_of:</code> is a similar function to <code>all_of</code> , but it can be used to remove variables with the operator <code>-</code>, e.g., <code>any_of(-vector_of_variables)</code> ;</p></li>
<li><p><code>contains</code>: allows to select variables that contains a specific string in their names. e.g., <code>contains(length)</code>;</p></li>
<li><p><code>ends_with</code>: variables that ends with a specific string pattern, e.g., <code>ends_with("_mm")</code>;</p></li>
<li><p><code>everything</code>: all variables, and already the default of the argument <code>.cols</code>;</p></li>
<li><p><code>last_col</code>: the last variable of the data.frame;</p></li>
<li><p><code>matches</code>: variables with a name that matches a given regular expression;</p></li>
<li><p><code>num_range</code>: variables that have a numeric sequence in their name, e.g., <code>var1</code>, <code>var2</code> and <code>var3</code> then we can use <code>num_range("var",1:3)</code>;</p></li>
<li><p><code>starts_with</code>: variables that starts with a specific string pattern, e.g., <code>starts_with("bill_")</code>.</p></li>
</ul>
</section>
<section id="by-order" class="level3">
<h3 class="anchored" data-anchor-id="by-order">By order</h3>
<p>Another method of column selection is using the name of the variables and the operator <code>:</code> to apply the function to a sequence of variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> bill_length_mm<span class="sc">:</span>body_mass_g,<span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 4
$ bill_length_mm    &lt;dbl&gt; 43.92193
$ bill_depth_mm     &lt;dbl&gt; 17.15117
$ flipper_length_mm &lt;dbl&gt; 200.9152
$ body_mass_g       &lt;dbl&gt; 4201.754</code></pre>
</div>
</div>
<p>In the example above we compute the mean to every variable from <code>bill_length_mm</code> to <code>body_mass_g</code>.</p>
<p>We can see that this variables are third to sixth of the data.frame, then can also use a method to reference them by their position.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 4
$ bill_length_mm    &lt;dbl&gt; 43.92193
$ bill_depth_mm     &lt;dbl&gt; 17.15117
$ flipper_length_mm &lt;dbl&gt; 200.9152
$ body_mass_g       &lt;dbl&gt; 4201.754</code></pre>
</div>
</div>
<p>In the example above we computed the mean for the same variables as before, but now using their column position instead.</p>
</section>
</section>
<section id="fns" class="level2">
<h2 class="anchored" data-anchor-id="fns">.fns</h2>
<p>The argument <code>.fns</code> determine which functions are going to be applied, this argument is:</p>
<ul>
<li><p>Non-optional</p></li>
<li><p>No default</p></li>
<li><p>Accepts as input:</p>
<ul>
<li><p>Single function;</p></li>
<li><p>List of functions.</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">where</span>(is.numeric),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> <span class="fu">list</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span><span class="fu">median</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 10
$ bill_length_mm_1    &lt;dbl&gt; 43.92193
$ bill_length_mm_2    &lt;dbl&gt; 44.45
$ bill_depth_mm_1     &lt;dbl&gt; 17.15117
$ bill_depth_mm_2     &lt;dbl&gt; 17.3
$ flipper_length_mm_1 &lt;dbl&gt; 200.9152
$ flipper_length_mm_2 &lt;dbl&gt; 197
$ body_mass_g_1       &lt;dbl&gt; 4201.754
$ body_mass_g_2       &lt;dbl&gt; 4050
$ year_1              &lt;dbl&gt; 2008.029
$ year_2              &lt;dbl&gt; 2008</code></pre>
</div>
</div>
<p>The mean and median are computed in the aforementioned example, but since more than one function is applied to the same variable, a numerical suffix is added based on the order in which our functions were defined inside the list, making mean 1 and median 2. This can be confusing and lead to errors later on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">where</span>(is.numeric),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> <span class="fu">list</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 10
$ bill_length_mm_mean      &lt;dbl&gt; 43.92193
$ bill_length_mm_median    &lt;dbl&gt; 44.45
$ bill_depth_mm_mean       &lt;dbl&gt; 17.15117
$ bill_depth_mm_median     &lt;dbl&gt; 17.3
$ flipper_length_mm_mean   &lt;dbl&gt; 200.9152
$ flipper_length_mm_median &lt;dbl&gt; 197
$ body_mass_g_mean         &lt;dbl&gt; 4201.754
$ body_mass_g_median       &lt;dbl&gt; 4050
$ year_mean                &lt;dbl&gt; 2008.029
$ year_median              &lt;dbl&gt; 2008</code></pre>
</div>
</div>
<p>Since we defined the names of the functions in the example above and added them automatically as suffixes, it is now clearer what we are doing.</p>
</section>
<section id="names" class="level2">
<h2 class="anchored" data-anchor-id="names">.names</h2>
<p>The argument <code>.names</code> determines the name of resultant the variables after the functions are applied, so it allows us to change the names of the variables, this argument is:</p>
<ul>
<li><p>Optional</p></li>
<li><p>The default is <code>NULL</code></p></li>
<li><p>Accepts as input:</p>
<ul>
<li>A string, where we can use <code>{.col}</code> and <code>{.fn}</code> as variables to receive the respective names of the columns and/or functions.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">where</span>(is.numeric),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> <span class="fu">list</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(.,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">.names =</span> <span class="st">"{.fn}----{.col}"</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 10
$ `mean----bill_length_mm`      &lt;dbl&gt; 43.92193
$ `median----bill_length_mm`    &lt;dbl&gt; 44.45
$ `mean----bill_depth_mm`       &lt;dbl&gt; 17.15117
$ `median----bill_depth_mm`     &lt;dbl&gt; 17.3
$ `mean----flipper_length_mm`   &lt;dbl&gt; 200.9152
$ `median----flipper_length_mm` &lt;dbl&gt; 197
$ `mean----body_mass_g`         &lt;dbl&gt; 4201.754
$ `median----body_mass_g`       &lt;dbl&gt; 4050
$ `mean----year`                &lt;dbl&gt; 2008.029
$ `median----year`              &lt;dbl&gt; 2008</code></pre>
</div>
</div>
<p>In the example above we change the variables names so they start with the function applied followed by 4 hyphens and then the original columns names.</p>
</section>
</section>
<section id="c_across" class="level1">
<h1>c_across</h1>
<p>The function <code>c_across</code> is a cousin of <code>across</code> , let´s construct another data.frame to showcase it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>xpenguins <span class="ot">&lt;-</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  penguins <span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">heaviest =</span> <span class="fu">max</span>(body_mass_g,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">lightest =</span> <span class="fu">min</span>(body_mass_g,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>species) <span class="sc">%&gt;%</span> </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> species,<span class="at">values_from =</span> value)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>xpenguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 4
  name     Adelie Chinstrap Gentoo
  &lt;chr&gt;     &lt;int&gt;     &lt;int&gt;  &lt;int&gt;
1 heaviest   4775      4800   6300
2 lightest   2850      2700   3950</code></pre>
</div>
</div>
<p>In the preceding example, we create a data.frame in wide format, with a column for each species and two rows representing the heaviest and lightest penguins of each. Assume our goal is to calculate the total weight of the heaviest and lightest penguins, which entails adding the weights of the three species in a fourth column called <code>total weight</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>xpenguins <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_weight =</span> Adelie <span class="sc">+</span> Chinstrap <span class="sc">+</span> Gentoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 5
  name     Adelie Chinstrap Gentoo total_weight
  &lt;chr&gt;     &lt;int&gt;     &lt;int&gt;  &lt;int&gt;        &lt;int&gt;
1 heaviest   4775      4800   6300        15875
2 lightest   2850      2700   3950         9500</code></pre>
</div>
</div>
<p>We can use a simple solution of manually entering each variable name and adding each other, which works but is not ideal, especially when we have many columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>xpenguins <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_weight =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="sc">-</span>name)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 5
# Rowwise: 
  name     Adelie Chinstrap Gentoo total_weight
  &lt;chr&gt;     &lt;int&gt;     &lt;int&gt;  &lt;int&gt;        &lt;int&gt;
1 heaviest   4775      4800   6300        15875
2 lightest   2850      2700   3950         9500</code></pre>
</div>
</div>
<p>An alternative is to apply <code>c_across</code>, first it works together with the verb <code>rowwise</code> that make the commands below it to operate by row, not column.</p>
<p>Not only that, but <code>c_across</code> differs from <code>across</code> in that it has only a <code>.cols</code> argument, so it must be placed within a function, which provides an advantage over the first approach in that we can now use the functions arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>xpenguins_na <span class="ot">&lt;-</span> xpenguins</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>xpenguins_na[<span class="dv">1</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>xpenguins_na <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_weight_plus =</span> Adelie <span class="sc">+</span> Chinstrap <span class="sc">+</span> Gentoo,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_weight_cacross =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="sc">-</span>name),<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 6
# Rowwise: 
  name     Adelie Chinstrap Gentoo total_weight_plus total_weight_cacross
  &lt;chr&gt;     &lt;int&gt;     &lt;int&gt;  &lt;int&gt;             &lt;int&gt;                &lt;int&gt;
1 heaviest   4775        NA   6300                NA                11075
2 lightest   2850      2700   3950              9500                19000</code></pre>
</div>
</div>
<p>Finally, above we show what would happen if we had an <code>NA</code> in the data. Most functions in R by default give <code>NA</code> as results if a <code>NA</code> is present in the data, so we can benefit from the use of the function <code>sum</code>, since it has an argument to ignore them (<code>na.rm = TRUE</code>).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Blog made with <a href="https://quarto.org/">Quarto</a>, by <a href="https://github.com/vbfelix/vbfelix.github.io">Vinícius Félix</a>. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>