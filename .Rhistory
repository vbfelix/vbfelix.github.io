mean = mean(value),
xcut = cut = cut(id,seq(0,100,10)),
n <- 100
set.seed(213);x <- rnorm(n,mean = 3,sd = 3)
ma_data <-
tibble(
id = 1:n,
x = x,
Trend = cumsum(x) + 2*x,
Seasonality = sin(sqrt(id)*3)
) %>%
pivot_longer(cols = c(Trend,Seasonality)) %>%
group_by(name) %>%
mutate(
mean = mean(value),
xcut = cut = cut(id,seq(0,100,10))
n <- 100
set.seed(213);x <- rnorm(n,mean = 3,sd = 3)
ma_data <-
tibble(
id = 1:n,
x = x,
Trend = cumsum(x) + 2*x,
Seasonality = sin(sqrt(id)*3)
) %>%
pivot_longer(cols = c(Trend,Seasonality)) %>%
group_by(name) %>%
mutate(
mean = mean(value),
xcut = cut(id,seq(0,100,10))
) %>%
ungroup()
ma_data %>%
group_by(name,xcut) %>%
mutate(
x = mean(id),
xmin = min(id),
xmax = max(id)
y = mean(value)
)
ma_data %>%
group_by(name,xcut) %>%
mutate(
x = mean(id),
xmin = min(id),
xmax = max(id),
y = mean(value)
)
ma_aux <-
ma_data %>%
group_by(name,xcut) %>%
mutate(
x = mean(id),
xmin = min(id),
xmax = max(id),
y = mean(value)
)
ma_plot +
geom_errorbarh(aes(x = x, y = y, xmin = xmin,xmax = xmax))
ma_plot +
geom_errorbarh(data = max_aux,aes(x = x, y = y, xmin = xmin,xmax = xmax))
ma_aux <-
ma_data %>%
group_by(name,xcut) %>%
mutate(
x = mean(id),
xmin = min(id),
xmax = max(id),
y = mean(value)
)
ma_plot +
geom_errorbarh(data = max_aux,aes(x = x, y = y, xmin = xmin,xmax = xmax))
ma_plot +
geom_errorbarh(data = ma_aux,aes(x = x, y = y, xmin = xmin,xmax = xmax))
ma_plot +
geom_errorbarh(data = ma_aux,aes(x = x, y = y, xmin = xmin,xmax = xmax, col = "Moving average"))
ma_plot +
geom_errorbarh(data = ma_aux,aes(y = y, xmin = xmin,xmax = xmax, col = "Moving average"),
linewidth = 1)
ma_plot +
geom_errorbarh(data = ma_aux,aes(y = y, xmin = xmin,xmax = xmax, col = "Moving average"),
linewidth = 1)+
geom_point(data = ma_aux,aes(y = y, x = x, col = "Moving average"),
linewidth = 1)
ma_plot +
geom_errorbarh(data = ma_aux,aes(y = y, xmin = xmin,xmax = xmax, col = "Moving average"),
linewidth = 1)+
geom_point(data = ma_aux,aes(y = y, x = x, col = "Moving average"),
size = 1)
ma_plot +
geom_errorbarh(data = ma_aux,aes(y = y, xmin = xmin,xmax = xmax, col = "Moving average"),
linewidth = 1)+
geom_point(data = ma_aux,aes(y = y, x = x, col = "Moving average"),
size = 3)
x1 <- c(1,2,2,3,3,3,4,5,5,5,7)
x1
tibble(arithmetic = calc_mean(x1,"arithmetic"))
x1 <- c(1,2,2,3,3,3,4,5,5,5,7)
x1
tibble(arithmetic = calc_mean(x1,"arithmetic"))
# usual data
ex0 <- c(1,2,2,3,3,3,4,5,5,5,7)
# small value
ex1 <- c(.1,2,2,3,3,3,4,5,5,5,7)
# large value
ex2 <- c(1,2,2,3,3,3,4,5,5,5,100)
# skewed values
set.seed(123);ex3 <- tibble(x = rexp(n = 1000,rate = .5)) %>%
filter(x < 10)
# normal values
set.seed(123);ex4 <- tibble(x = rnorm(n = 1000)) %>%
filter(x != 0)
ex0
tibble(arithmetic = calc_mean(ex0,"arithmetic"))
ex1
tibble(arithmetic = calc_mean(ex1,"arithmetic")) %>%
kable()
x2
mean(x2)
ex2
mean(ex2)
ex2
tibble(arithmetic = calc_mean(ex2,"arithmetic")) %>%
kable()
amean <- mean(ex3$x)
gmean <- relper::calc_mean(ex3$x,"geometric")
hmean <- relper::calc_mean(ex3$x,"harmonic")
plot <-
ex3 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
limits = c(0,10),
expand = c(0,0),
breaks = 0:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a exponential distribution"
)+
geom_vline(aes(xintercept = amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
plot
plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
limits = c(0,10),
expand = c(0,0),
breaks = 0:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a exponential distribution"
)+
geom_vline(aes(xintercept = amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
plot
# usual data
ex0 <- c(1,2,2,3,3,3,4,5,5,5,7)
# small value
ex1 <- c(.1,2,2,3,3,3,4,5,5,5,7)
# large value
ex2 <- c(1,2,2,3,3,3,4,5,5,5,100)
# skewed values
set.seed(123);ex3 <- tibble(x = rexp(n = 1000,rate = .5)) %>%
filter(x < 10)
# normal values
set.seed(123);ex4 <- tibble(x = rnorm(n = 1000)) %>%
filter(x != 0)
plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
limits = c(0,10),
expand = c(0,0),
breaks = 0:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a normal  distribution"
)+
geom_vline(aes(xintercept = amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
plot
plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
limits = c(0,10),
expand = c(0,0),
breaks = 0:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a normal  distribution"
)+
# geom_vline(aes(xintercept = amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
plot
plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
# limits = c(0,10),
expand = c(0,0),
breaks = 0:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a normal  distribution"
)+
# geom_vline(aes(xintercept = amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
plot
plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
# limits = c(0,10),
expand = c(0,0),
breaks = -10:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a normal  distribution"
)+
# geom_vline(aes(xintercept = amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
plot
ex4_amean <- mean(ex4$x)
ex4_gmean <- relper::calc_mean(ex4$x,"geometric")
ex4_hmean <- relper::calc_mean(ex4$x,"harmonic")
plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
# limits = c(0,10),
expand = c(0,0),
breaks = -10:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a normal  distribution"
)+
geom_vline(aes(xintercept = amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
plot
ex4_amean <- mean(ex4$x)
ex4_gmean <- relper::calc_mean(ex4$x,"geometric")
ex4_hmean <- relper::calc_mean(ex4$x,"harmonic")
plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
# limits = c(0,10),
expand = c(0,0),
breaks = -10:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a normal  distribution"
)+
geom_vline(aes(xintercept = ex4_amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
plot
ex4_amean <- mean(ex4$x)
ex4_gmean <- relper::calc_mean(ex4$x,"geometric")
ex4_hmean <- relper::calc_mean(ex4$x,"harmonic")
ex4_plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
# limits = c(0,10),
expand = c(0,0),
breaks = -10:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a normal  distribution"
)+
geom_vline(aes(xintercept = ex4_amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
ex4_plot
ex4_amean <- mean(ex4$x)
ex4_gmean <- relper::calc_mean(ex4$x,"geometric")
ex4_hmean <- relper::calc_mean(ex4$x,"harmonic")
ex4_plot <-
ex4 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
# limits = c(0,10),
expand = c(0,0),
breaks = -10:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a normal  distribution"
)+
geom_vline(aes(xintercept = ex4_amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
ex4_plot
ex2
tibble(trimmed = mean(ex2,trim = .1))
trimmed <- c(2,2,3,3,3,4,5,5,5)
trimmed
tibble(arithmetic  = mean(trimmed))
ex1
tibble(
arithmetic = relper::calc_mean(ex1,"arithmetic"),
geometric = relper::calc_mean(ex1,"geometric")
) %>%
kable()
ex_growth <- c(.1,.2,.3,.05,.004)
ex_growth
tibble(
arithmetic = relper::calc_mean(ex_growth,"arithmetic"),
geometric = relper::calc_mean(ex_growth,"geometric")
) %>%
kable()
ex0
tibble(
arithmetic = relper::calc_mean(ex0,"arithmetic"),
geometric = relper::calc_mean(ex0,"geometric")
) %>%
kable()
ex1
tibble(
arithmetic = relper::calc_mean(ex1,"arithmetic"),
geometric = relper::calc_mean(ex1,"geometric")
) %>%
kable()
ex2
tibble(
arithmetic = relper::calc_mean(ex2,"arithmetic"),
geometric = relper::calc_mean(ex2,"geometric")
) %>%
kable()
ex3_amean <- mean(ex3$x)
ex3_gmean <- relper::calc_mean(ex3$x,"geometric")
ex3_hmean <- relper::calc_mean(ex3$x,"harmonic")
ex3_plot <-
ex3 %>%
ggplot(aes(x = x))+
geom_density(fill = "grey45", alpha = .5)+
plt_theme_x(margin = .6)+
plt_water_mark(vfx_watermark)+
scale_x_continuous(
limits = c(0,10),
expand = c(0,0),
breaks = 0:10
)+
scale_y_continuous(expand = c(0,0))+
labs(
x = "",
y = "",
col = "",
subtitle = "Density of a exponential distribution"
)+
geom_vline(aes(xintercept = amean,col = "Arithmetic"), linewidth = 1)+
scale_color_manual(values = palette_qua("ted_lasso",F))
ex3_plot
ex3_plot+
geom_vline(aes(xintercept = gmean,col = "Geometric"), linewidth = 1)
ex3_plot+
geom_vline(aes(xintercept = ex3_gmean,col = "Geometric"), linewidth = 1)
ex4_plot+
geom_vline(aes(xintercept = ex4_gmean,col = "Geometric"), linewidth = 1)
calc_mean(ex4$x)
calc_mean(ex4$x,"geometric")
calc_mean(ex4$x[ex4$x > 0],"geometric")
ex0
tibble(
arithmetic = relper::calc_mean(ex0,"arithmetic"),
geometric = relper::calc_mean(ex0,"geometric"),
harmonic = relper::calc_mean(ex0,"harmonic")
) %>%
kable()
ex1
tibble(
arithmetic = relper::calc_mean(ex1,"arithmetic"),
geometric = relper::calc_mean(ex1,"geometric"),
harmonic = relper::calc_mean(ex1,"harmonic")
) %>%
kable()
ex2
tibble(
arithmetic = relper::calc_mean(ex2,"arithmetic"),
geometric = relper::calc_mean(ex2,"geometric"),
harmonic = relper::calc_mean(ex2,"harmonic")
) %>%
kable()
ex3_plot+
geom_vline(aes(xintercept = ex3_gmean,col = "Geometric"), linewidth = 1)+
geom_vline(aes(xintercept = ex3_hmean,col = "Harmonic"), linewidth = 1)
ex4_plot+
geom_vline(aes(xintercept = ex4_gmean,col = "Geometric"), linewidth = 1)+
geom_vline(aes(xintercept = ex4_hmean,col = "Harmonic"), linewidth = 1)
n <- 100
set.seed(213);x <- rnorm(n,mean = 3,sd = 3)
ma_data <-
tibble(
id = 1:n,
x = x,
Trend = cumsum(x) + 2*x,
Seasonality = sin(sqrt(id)*3)
) %>%
pivot_longer(cols = c(Trend,Seasonality)) %>%
group_by(name) %>%
mutate(
mean = mean(value),
xcut = cut(id,seq(0,100,10))
) %>%
ungroup()
ma_plot<-
ma_data %>%
ggplot(aes(id,value))+
geom_line()+
facet_grid(rows = vars(name),scales = "free_y")+
plt_theme_y()+
plt_water_mark(vfx_watermark)+
scale_x_continuous(breaks = seq(0,100,10))+
labs(x = "",y = "", col = "")+
geom_hline(aes(yintercept = mean,col = "Average" ), linewidth = 1)
ma_plot
ma_aux <-
ma_data %>%
group_by(name,xcut) %>%
mutate(
x = mean(id),
xmin = min(id),
xmax = max(id),
y = mean(value)
)
ma_plot +
geom_errorbarh(data = ma_aux,aes(y = y, xmin = xmin,xmax = xmax, col = "Moving average"),
linewidth = 1)+
geom_point(data = ma_aux,aes(y = y, x = x, col = "Moving average"),
size = 3)
?mean
?weighted.mean()
?mean
x <- c(1,2,2,2,2,2,3,3,4,4,4,5,5,5,5,7)
#simple arithmetic mean
relper::calc_mean(x = x,type = "arithmetic")
#weighted arithmetic mean
relper::calc_mean(x = x,type = "arithmetic")
#trimmed arithmetic mean
relper::calc_mean(x = x,type = "arithmetic")
#geometric mean
relper::calc_mean(x = x,type = "geometric")
#harmonic mean
relper::calc_mean(x = x,type = "harmonic")
