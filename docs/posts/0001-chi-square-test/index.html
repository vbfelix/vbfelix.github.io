<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vinícius Félix">
<meta name="dcterms.date" content="2023-01-01">

<title>vbfelix - An intro to chi-square test</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//images/favicon/favicon-32x32.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">vbfelix</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../header-about.html">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../header-publications.html">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../header-certifications.html">
 <span class="menu-text">Certifications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../header-talks.html">
 <span class="menu-text">Events</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vbfelix"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/vin%C3%ADcius-f%C3%A9lix-962010140/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://stackoverflow.com/users/9696037/vin%c3%adcius-f%c3%a9lix"><i class="bi bi-stack-overflow" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://vbfelix.github.io/relper"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">An intro to chi-square test</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Intro to</div>
                <div class="quarto-category">Theory</div>
                <div class="quarto-category">Hypothesis test</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vinícius Félix </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 1, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#context" id="toc-context" class="nav-link active" data-scroll-target="#context">Context</a></li>
  <li><a href="#math" id="toc-math" class="nav-link" data-scroll-target="#math">Math</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#test-statistic" id="toc-test-statistic" class="nav-link" data-scroll-target="#test-statistic">Test statistic</a></li>
  <li><a href="#p-value" id="toc-p-value" class="nav-link" data-scroll-target="#p-value">p-value</a></li>
  </ul></li>
  <li><a href="#in-practice-with-r" id="toc-in-practice-with-r" class="nav-link" data-scroll-target="#in-practice-with-r">In practice with R</a>
  <ul class="collapse">
  <li><a href="#contingency-table" id="toc-contingency-table" class="nav-link" data-scroll-target="#contingency-table">Contingency table</a></li>
  <li><a href="#raw-data" id="toc-raw-data" class="nav-link" data-scroll-target="#raw-data">Raw data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>In this post of the series <strong>Intro to</strong>, I’ll give an introduction to the chi-square test, one of the most well-known statistical tests.</p>
<section id="context" class="level1">
<h1>Context</h1>
<p>To investigate a probability criterion on any theory of an observed system of errors and to apply it in order to establish a goodness of fit (GoF) measure, Karl Pearson published a paper <span class="citation" data-cites="pearson1900">(<a href="#ref-pearson1900" role="doc-biblioref">Pearson 1900</a>)</span>, the reason why the test is also known as Pearson’s chi-square test<span class="smallcaps">.</span></p>
<p>We can test how likely a variable is to come from a specified distribution in this application because we have a metric to check whether or not our observed values are close to or not to the expected values, in this case we can define hypotheses as:</p>
<ul>
<li><p><span class="math inline">\(H_0:\)</span> The variable follows a specific distribution;</p></li>
<li><p><span class="math inline">\(H_1:\)</span> The variable does not follow a specific distribution.</p></li>
</ul>
<p>Despite Pearson’s primary goal, the chi-square test is most commonly used to test the association or independence of two categorical variables. To do so, we look at how common a particular categorical feature is among two or more groups. So we can establish the hypotheses as:</p>
<ul>
<li><p><span class="math inline">\(H_0:\)</span> The two variables are independent;</p></li>
<li><p><span class="math inline">\(H_1:\)</span> The two variables are not independent.</p></li>
</ul>
<p>Meaning that the test does not differentiate one variable from another in any causal way.</p>
</section>
<section id="math" class="level1">
<h1>Math</h1>
<p>To begin the math, we will dissect the test statistic, given by the <a href="#eq-chi-square-stat">Equation&nbsp;1</a>:</p>
<p><span id="eq-chi-square-stat"><span class="math display">\[
\begin{equation}
X^2 = \sum_{i = 1}^{k} \frac{(O_i - E_i)^2}{E_i},
\end{equation}
\tag{1}\]</span></span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(X^2\)</span> is the test statistic;</p></li>
<li><p><span class="math inline">\(O_i\)</span> is the observed value of the class <span class="math inline">\(i\)</span>;</p></li>
<li><p><span class="math inline">\(E_i\)</span> is the expected value of the class <span class="math inline">\(i\)</span>;</p></li>
<li><p><span class="math inline">\(k\)</span> is the total number of classes, i.e., number of combinations of the two variables .</p></li>
</ul>
<p>The pre-requisites behind the test are:</p>
<ul>
<li><p>Two categorical variables;</p></li>
<li><p>Two or more levels for each variable;</p></li>
<li><p>The observations are independent, i.e., no paired observations or longitudinal data;</p></li>
<li><p>A random sample of size <span class="math inline">\(n\)</span> where each <span class="math inline">\(O_i\)</span> falls in one of the <span class="math inline">\(k\)</span> mutually exclusives classes;</p></li>
<li><p>A null hypothesis that with a probability of <span class="math inline">\(p_i\)</span> that each <span class="math inline">\(O_i\)</span> belongs to one of the <span class="math inline">\(k\)</span>’s classes.</p></li>
</ul>
<p>So considering the test statistic, Pearson proposed that under a true null hypothesis and an asymptotic <span class="math inline">\(n\)</span>, the test statistic will follow a <span class="math inline">\(X_{q}^2\)</span> distribution, where <span class="math inline">\(q\)</span> is the number of degrees of freedom. But how?</p>
<p>The reasoning is that we can describe the observed values following a Binomial distribution, <span class="math inline">\(O_i \sim Binomial(n,p_i)\)</span>, since this distribution describes the phenomenon of the number of sucesses given a total number of trials (<span class="math inline">\(n\)</span>), where the true success rate is (<span class="math inline">\(p_i\)</span>), giving this distribution we have that:</p>
<p><span id="eq-binomial-mean"><span class="math display">\[
\begin{equation}
E(O_i) = E_i =  np_i,
\end{equation}
\tag{2}\]</span></span></p>
<p>and</p>
<p><span id="eq-binomial-var"><span class="math display">\[
\begin{equation}
Var(O_i) = np_i(1-p_i).
\end{equation}
\tag{3}\]</span></span></p>
<p>Given a sample size that is sufficient large, we can use a result of the central limit theorem <span class="citation" data-cites="pearson1900 cam1986">(<a href="#ref-pearson1900" role="doc-biblioref">Pearson 1900</a>; <a href="#ref-cam1986" role="doc-biblioref">Cam 1986</a>)</span> that gives us that:</p>
<p><span id="eq-clt"><span class="math display">\[
\begin{equation}
Z = \frac{Y-\mu}{\sqrt{\sigma^2}} \longrightarrow \mathcal{N}(0,1),
\end{equation}
\tag{4}\]</span></span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span> is the sum of random independent and identically distributed variables, with the same mean and variance;</p></li>
<li><p><span class="math inline">\(\mu\)</span> is the mean;</p></li>
<li><p><span class="math inline">\(\sigma^2\)</span> is the variance;</p></li>
<li><p><span class="math inline">\(\mathcal{N}\)</span> is a normal distribution.</p></li>
</ul>
<p>So applying the approximation of the normal to a binomial distribution:</p>
<p><span id="eq-normal-to-binomial"><span class="math display">\[
Binomial(n,p_i) \approx N(np_i,np_i(1-p_i)).
\tag{5}\]</span></span></p>
<p>Now, if we square a random variable <span class="math inline">\(Z_1\)</span> that follows a standard normal distribution <span class="math inline">\(\mathcal{N}(0,1)\)</span>, we have that:</p>
<p><span id="eq-z1-to-chi1"><span class="math display">\[
Z_1^2 = \chi_1^2,
\tag{6}\]</span></span></p>
<p>and if we sum two squared variables, such as <span class="math inline">\(Z_1\)</span> and <span class="math inline">\(Z_2\)</span>:</p>
<p><span id="eq-z2-to-chi2"><span class="math display">\[
Z_1^2 + Z_2^2 = \chi_2^2.
\tag{7}\]</span></span></p>
<p>Then,</p>
<p><span id="eq-normal-chi-square"><span class="math display">\[
\sum_{i = 1}^{q} Z_i^2  = \chi_q^2,
\tag{8}\]</span></span></p>
<p>Now using <a href="#eq-clt">Equation&nbsp;4</a> and <a href="#eq-normal-to-binomial">Equation&nbsp;5</a> we can write that:</p>
<p><span id="eq-z"><span class="math display">\[
\begin{align}
Z
&amp;= \frac{Y-\mu}{\sqrt{\sigma^2}} \\
&amp;=  \frac{O_i - np_i}{\sqrt{np_i(1-p_i)}}. \\
\end{align}
\tag{9}\]</span></span></p>
<p>So having a variable <span class="math inline">\(X_1 = Z^2\)</span>, we apply the results from <a href="#eq-normal-chi-square">Equation&nbsp;8</a> and <a href="#eq-z">Equation&nbsp;9</a> :</p>
<p><span id="eq-x1"><span class="math display">\[
\begin{align}
Z^2
&amp;= \left[ \frac{Y-\mu}{\sqrt{\sigma^2}} \right]^2 \\
&amp;= \left[ \frac{O_1 - np_1}{\sqrt{np_1(1-p_1)}}  \right]^2 \\
&amp;= \frac{ (O_1 - np_1) ^2}{(\sqrt{np_1(1-p_1)})^2}   \\
&amp;= \frac{ (O_1 - np_1) ^2}{np_1(1-p_1)}   \\
&amp;= \frac{ (O_1 - np_1) ^2}{np_1(1-p_1)}  \times[(1-p_1)+p_1] \\
&amp;= \frac{ (O_1 - np_1) ^2(1-p_1)}{np_1(1-p_1)} + \frac{ (O_1 - np_1)^2(p_1)}{np_1(1-p_1)}    \\
&amp;= \frac{ (O_1 - np_1)^2}{np_1} + \frac{ (O_1 - np_1)^2}{n(1-p_1)}.    \\
\end{align}
\tag{10}\]</span></span></p>
<p>Considering now a second variable, <span class="math inline">\(X_2\)</span>, where:</p>
<p><span id="eq-x2"><span class="math display">\[
X_1 = n - X_2 \longrightarrow X_2 = n-X_1,
\tag{11}\]</span></span></p>
<p>and,</p>
<p><span id="eq-p2"><span class="math display">\[
p_1 = 1- p_2 \longrightarrow p_2 = 1 - p_1.
\tag{12}\]</span></span></p>
<p>We apply the <a href="#eq-x2">Equation&nbsp;11</a> and <a href="#eq-p2">Equation&nbsp;12</a> to <a href="#eq-x1">Equation&nbsp;10</a> and continue our desmonstration:</p>
<p><span id="eq-z2"><span class="math display">\[
\begin{align}
Z^2
&amp;= \frac{ (O_1 - np_1)^2}{np_1} + \frac{ (O_1 - np_1)^2}{n(1-p_1)}    \\
&amp;= \frac{ (O_1 - np_1)^2}{np_1} + \frac{ [(n - O_2)- n(1-p_2)]^2}{n(p_2)}    \\
&amp;= \frac{ (O_1 - np_1)^2}{np_1} + \frac{ [n - O_2- n+np_2]^2}{np_2}    \\
&amp;= \frac{ (O_1 - np_1)^2}{np_1} + \frac{ [-O_2+np_2]^2}{np_2}    \\
&amp;= \frac{ (O_1 - np_1)^2}{np_1} + \frac{ [-(O_2-np_2)]^2}{np_2}    \\
&amp;= \frac{ (O_1 - np_1)^2}{np_1} + \frac{ (O_2-np_2)^2}{np_2}    \\
&amp;= \frac{ (O_1 - E_1)^2}{E_1} + \frac{ (O_2-E_2)^2}{E_2}    \\
&amp;= \sum_{i=1}^{2}\frac{ (O_i - E_i)^2}{E_i}.    \\
\end{align}
\tag{13}\]</span></span></p>
<p>So we show that the sum of chi-squared variables results in the same formula as the test statistic, as shown in <a href="#eq-chi-square-stat">Equation&nbsp;1</a>.</p>
<p>Lastly, since we can also rewrite our statistic in <a href="#eq-chi-square-stat">Equation&nbsp;1</a>, using <a href="#eq-binomial-mean">Equation&nbsp;2</a>:</p>
<p><span id="eq-chi-square-stat-alt"><span class="math display">\[
\begin{align} &amp;= \sum_{i = 1}^{k} \left[ \frac{(O_i - E_i)^2}{E_i} \right] \\ &amp; = \sum_{i = 1}^{k} \left[  \frac{O_i^2}{E_i} - \frac{E_i^2}{E_i} \right] \\ &amp; = \sum_{i = 1}^{k} \left[  \frac{O_i^2}{E_i} -  E_i \right] \\ &amp; = \sum_{i = 1}^{k} \left[  \frac{O_i^2}{E_i} \right] - \sum_{i = 1}^{k}\left[ E_i \right] \\ &amp; = \sum_{i = 1}^{k} \left[  \frac{O_i^2}{E_i} \right] - \sum_{i = 1}^{k}\left[ n\times p_i \right] \\ &amp; = \sum_{i = 1}^{k} \left[  \frac{O_i^2}{E_i} \right] - n\sum_{i = 1}^{k}\left[ p_i \right] \\ &amp; = \sum_{i = 1}^{k} \left[  \frac{O_i^2}{E_i} \right] - n. \\ \end{align}
\tag{14}\]</span></span></p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>After all of these equations, we’ll perform a real-world example.</p>
<p>Let’s say we have 200 animals in our random sample, and we want to see if race has anything to do with frame size. In order to see our observed values in each class, i.e., race x frame, we will first look at a contingency table with the absolute frequency of animals:</p>
<table class="table">
<thead>
<tr class="header">
<th>Frame</th>
<th>Race 1</th>
<th>Race 2</th>
<th>Race 3</th>
<th>Frame Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Small</td>
<td>10</td>
<td>20</td>
<td>10</td>
<td><strong>40</strong></td>
</tr>
<tr class="even">
<td>Medium</td>
<td>20</td>
<td>30</td>
<td>20</td>
<td><strong>70</strong></td>
</tr>
<tr class="odd">
<td>Large</td>
<td>30</td>
<td>50</td>
<td>10</td>
<td><strong>90</strong></td>
</tr>
<tr class="even">
<td><strong>Race Total</strong></td>
<td><strong>60</strong></td>
<td><strong>100</strong></td>
<td><strong>40</strong></td>
<td><strong>200</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="test-statistic" class="level2">
<h2 class="anchored" data-anchor-id="test-statistic">Test statistic</h2>
<p>To compute our statistic, as given by the equation <a href="#eq-chi-square-stat">Equation&nbsp;1</a>, we have to:</p>
<ol type="1">
<li><p>Compute the expected value for each class (cell in terms of a contingency table);</p></li>
<li><p>Compute the component <span class="math inline">\(\frac{(O_i -E_i)^2}{E_i}\)</span> fo each class;</p></li>
<li><p>Compute the <span class="math inline">\(X^2\)</span> statistic by summing all values of step 2.</p></li>
</ol>
<p>To begin, we will perform the calculus for a single cell to demonstrate each step, and we will select the Race 1 x Small frame class. In this case, our observed value is 10, so we do the following to calculate the expected value:</p>
<p><span id="eq-example-part-01"><span class="math display">\[
E_1 = (40 \times 60)/200 = 12.
\tag{15}\]</span></span></p>
<p>We multiplied our marginal results and divided them by our sample size because one of our assumptions is that the variables are independent. We can now compute the component for the first cell using our expected value.</p>
<p><span id="eq-example-part-02"><span class="math display">\[
\begin{align}
&amp; =  \frac{(O_1 - E_1)^2}{E_1}  \\
&amp; =  \frac{(10 - 12)^2}{12}  \\
&amp; =  \frac{(-2)^2}{12}  \\
&amp; =  \frac{4}{12} \\
&amp; =  1/3.\\
\end{align}
\tag{16}\]</span></span></p>
<p>Now we apply the calculus to each cell, computing the expected value for every class:</p>
<table class="table">
<thead>
<tr class="header">
<th>Frame</th>
<th>Race 1</th>
<th>Race 2</th>
<th>Race 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Small</td>
<td>12</td>
<td>20</td>
<td>8</td>
</tr>
<tr class="even">
<td>Medium</td>
<td>21</td>
<td>35</td>
<td>14</td>
</tr>
<tr class="odd">
<td>Large</td>
<td>27</td>
<td>45</td>
<td>18</td>
</tr>
</tbody>
</table>
<p>And then we can also compute <span class="math inline">\(\frac{(O_i -E_i)^2}{E_i}\)</span> for each one:</p>
<table class="table">
<thead>
<tr class="header">
<th>Frame</th>
<th>Race 1</th>
<th>Race 2</th>
<th>Race 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Small</td>
<td>0.33</td>
<td>0</td>
<td>0.50</td>
</tr>
<tr class="even">
<td>Medium</td>
<td>0.05</td>
<td>0.71</td>
<td>2.57</td>
</tr>
<tr class="odd">
<td></td>
<td>0.33</td>
<td>0.56</td>
<td>3.56</td>
</tr>
</tbody>
</table>
<p>Lastly, we sum all the values to obtain the statistic <span class="math inline">\(X^2\)</span>, which is equal to 8.61.</p>
</section>
<section id="p-value" class="level2">
<h2 class="anchored" data-anchor-id="p-value">p-value</h2>
<p>Now, if we want to obtain the p value we have to look at the chi-sqaure distribution, so first we need to obtain the number of degrees of freedom <span class="math inline">\((q)\)</span>, in this cases that is given by:</p>
<p><span id="eq-dof-formula"><span class="math display">\[
q = (n_r-1)\times(n_c-1),
\tag{17}\]</span></span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(n_r\)</span> is the number of rows in the contingency table, i.e., the number of levels of the respective categorical variable;</p></li>
<li><p><span class="math inline">\(n_c\)</span> is the number of columns in the contingency table, i.e., the number of levels of the respective categorical variable.</p></li>
</ul>
<p>Then, we have in our example that</p>
<p><span id="eq-dof-example"><span class="math display">\[
\begin{align}
q &amp; =  (n_r-1)\times(n_c-1)  \\
&amp; =  (3-1) \times (3-1) \\
&amp; =  (2) \times (2) \\
&amp; =  4.\\
\end{align}
\tag{18}\]</span></span></p>
<p>With an established <span class="math inline">\(q\)</span>, we now can compute the p value given by:</p>
<p><span id="eq-p-value"><span class="math display">\[
P(\chi_4^2 &gt; X^2|H_0),
\tag{19}\]</span></span></p>
<p>or the probability that a value is larger than <span class="math inline">\(X^2\)</span> given a <span class="math inline">\(\chi_4^2\)</span> distribution and a true null hypothesis, as we can see in the figure below:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With a p value of 0.0716, we have that the p value is greater than 0.05, so we do not reject the null hypothesis, i.e., we do not have sample evidence to reject the null hypothesis that race and size frame are independent..</p>
</section>
</section>
<section id="in-practice-with-r" class="level1">
<h1>In practice with R</h1>
<p>In real life we are not going to do all of this calculations step by step, let’s how we can use R to help us.</p>
<section id="contingency-table" class="level2">
<h2 class="anchored" data-anchor-id="contingency-table">Contingency table</h2>
<p>If you have your contingency table ready, an easy and quick way to apply the test is to create a matrix with the observed values of each class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#matrix with the count </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">10</span>),<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   10   20   10
[2,]   20   30   20
[3,]   30   50   10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  data
X-squared = 8.6111, df = 4, p-value = 0.07159</code></pre>
</div>
</div>
<p>We can see that the function already show us the statistic, number of degrees of freedom and the p value.</p>
</section>
<section id="raw-data" class="level2">
<h2 class="anchored" data-anchor-id="raw-data">Raw data</h2>
<p>We usually work with raw data as data analysts, where each row represents one observation. In this case, we can transform our data to perform the same function as in the previous example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Raw data simulation</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">race  =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"S"</span>,<span class="st">"M"</span>,<span class="st">"L"</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(race,frame) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n  =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uncount</span>(n)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 x 2
    race frame
   &lt;int&gt; &lt;fct&gt;
 1     1 L    
 2     1 L    
 3     1 L    
 4     1 L    
 5     1 L    
 6     1 L    
 7     1 L    
 8     1 L    
 9     1 L    
10     1 L    
# ... with 190 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Number of observed values for each class</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(race,frame) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Pivot table to make a contingency table</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> race,<span class="at">values_from =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Removal of the variable as column</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Chi-square test</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  .
X-squared = 8.6111, df = 4, p-value = 0.07159</code></pre>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-cam1986" class="csl-entry" role="doc-biblioentry">
Cam, L. Le. 1986. <span>“The Central Limit Theorem Around 1935.”</span> <em>Statistical Science</em> 1 (1). <a href="https://doi.org/10.1214/ss/1177013818">https://doi.org/10.1214/ss/1177013818</a>.
</div>
<div id="ref-pearson1900" class="csl-entry" role="doc-biblioentry">
Pearson, Karl. 1900. <span>“X. <span><em>On the Criterion That a Given System of Deviations from the Probable in the Case of a Correlated System of Variables Is Such That It Can Be Reasonably Supposed to Have Arisen from Random Sampling</em></span>.”</span> <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em> 50 (302): 157–75. <a href="https://doi.org/10.1080/14786440009463897">https://doi.org/10.1080/14786440009463897</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Blog made with <a href="https://quarto.org/">Quarto</a>, by <a href="https://github.com/vbfelix/vbfelix.github.io">Vinícius Félix</a>. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</div>   
  </div>
</footer>



</body></html>