)
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl),
fontface = "bold",
nudge_y = 1
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl),
fontface = "bold",
nudge_y = 1
)+
scale_fill_brewer(palette = "Set1")
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "Expected - Observed"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "Expected - Observed"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "Expected - Observed"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual("black")
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "Expected - Observed"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "black")
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "Expected - Observed"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "darkgreen")
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "Observed - Expected"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "darkgreen")
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "(Observed - Expected)"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "darkgreen")
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "(Observed - Expected)"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "purple")
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "(Observed - Expected)"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "darkgoldenrod2")
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "(Observed - Expected)"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "grey")
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "(Observed - Expected)"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "grey78")
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "(Observed - Expected)"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "grey32")
prev_dice_df <-
expand_grid(dice1 = 1:6, dice2 = 1:6) %>%
mutate(dice_sum = dice1 + dice2) %>%
count(dice_sum) %>%
mutate(perc = 100*n/sum(n)) %>%
mutate(type = "Expected")
dice_df <-
real_dice_df %>%
bind_rows(
prev_dice_df
)
dice_df %>%
ggplot(aes(dice_sum,perc))+
geom_col(aes(fill = type, group = type),position = position_dodge2())+
plt_theme_y()+
scale_x_continuous(breaks = 2:12)+
scale_y_continuous(expand = c(.01,0), breaks = seq(0,20,2), limits = c(0,19))+
labs(
x = "Sum of the two dices",
y = "Proportion (%)",
fill = "",
col = ""
)+
geom_text(
data = dice_df %>% select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
),
mapping = aes(label = diff_lbl, col = "(Observed - Expected)"),
fontface = "bold",
nudge_y = 1.2
)+
scale_fill_brewer(palette = "Set1")+
scale_color_manual(values = "grey50")
dice_real_prev <-
dice_df %>%
select(-n) %>%
pivot_wider(names_from = type,values_from = perc) %>%
mutate(
perc = (Observed + Expected)/2,
diff_lbl =  format_num(Observed - Expected)
)
dice_real_prev
chisq.test(dice_real_prev$Observed,dice_real_prev$Expected)
chisq.test(real_dice_df$n,p = dice_real_prev$Expected/100)
chisq.test(dice_real_prev$Observed,dice_real_prev$Expected)
chisq.test(real_dice_df$n,p = dice_real_prev$Expected/100)
chisq.test(c(10,10,10,10),p = c(.25,.25,.25,.25))
chisq.test(c(10,10,10,10),p = c(.1,.2,.3,.4))
chisq.test(real_dice_df$n,p = dice_real_prev$Expected/100)
real_dice_df$n
real_dice_df
dice_real_prev
chisq.test(real_dice_df$n,p = dice_real_prev$Expected/100)
real_dice_df$n
chisq.test(real_dice_df$n,p = dice_real_prev$Expected/100)
